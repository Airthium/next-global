{"version":3,"sources":["../../../../src/server/index.ts"],"sourcesContent":["/** @module Server */\n\nimport { createServer } from 'http'\nimport { parse } from 'url'\nimport next from 'next'\n\nconst port = parseInt(process.env.PORT ?? '3000', 10)\nconst hostname = 'localhost'\nconst dev = process.env.NODE_ENV !== 'production'\nconst app = next({ dev, hostname, port })\nconst handle = app.getRequestHandler()\n\n// Initialize\nObject.defineProperty(global, 'myvar', {\n  value: { test: true },\n  configurable: true,\n})\n// Server\napp\n  .prepare()\n  .then(() => {\n    createServer((req, res) => {\n      try {\n        const parsedUrl = parse(req.url!, true)\n        handle(req, res, parsedUrl).catch((err) => {\n          console.error(err)\n          res.statusCode = 500\n          res.end('Internal server error')\n        })\n      } catch (err) {\n        console.error(err)\n        res.statusCode = 500\n        res.end('Internal server error')\n      }\n    }).listen(port)\n\n    console.info(\n      `> Server listening at http://localhost:${port} as ${\n        dev ? 'development' : process.env.NODE_ENV\n      }`\n    )\n  })\n  .catch(console.error)\n\n// Clean\nconst handleExit = (code: number): void => {\n  console.info('> Server stopped')\n  process.exit(code)\n}\n\nprocess.on('exit', (code) => handleExit(code))\n"],"names":["createServer","parse","next","port","parseInt","process","env","PORT","hostname","dev","NODE_ENV","app","handle","getRequestHandler","Object","defineProperty","global","value","test","configurable","prepare","then","req","res","parsedUrl","url","catch","err","console","error","statusCode","end","listen","info","handleExit","code","exit","on"],"mappings":"AAAA,mBAAmB,GAEnB,SAASA,YAAY,QAAQ,OAAM;AACnC,SAASC,KAAK,QAAQ,MAAK;AAC3B,OAAOC,UAAU,OAAM;AAEvB,MAAMC,OAAOC,SAASC,QAAQC,GAAG,CAACC,IAAI,IAAI,QAAQ;AAClD,MAAMC,WAAW;AACjB,MAAMC,MAAMJ,QAAQC,GAAG,CAACI,QAAQ,KAAK;AACrC,MAAMC,MAAMT,KAAK;IAAEO;IAAKD;IAAUL;AAAK;AACvC,MAAMS,SAASD,IAAIE,iBAAiB;AAEpC,aAAa;AACbC,OAAOC,cAAc,CAACC,QAAQ,SAAS;IACrCC,OAAO;QAAEC,MAAM;IAAK;IACpBC,cAAc;AAChB;AACA,SAAS;AACTR,IACGS,OAAO,GACPC,IAAI,CAAC;IACJrB,aAAa,CAACsB,KAAKC;QACjB,IAAI;YACF,MAAMC,YAAYvB,MAAMqB,IAAIG,GAAG,EAAG;YAClCb,OAAOU,KAAKC,KAAKC,WAAWE,KAAK,CAAC,CAACC;gBACjCC,QAAQC,KAAK,CAACF;gBACdJ,IAAIO,UAAU,GAAG;gBACjBP,IAAIQ,GAAG,CAAC;YACV;QACF,EAAE,OAAOJ,KAAK;YACZC,QAAQC,KAAK,CAACF;YACdJ,IAAIO,UAAU,GAAG;YACjBP,IAAIQ,GAAG,CAAC;QACV;IACF,GAAGC,MAAM,CAAC7B;IAEVyB,QAAQK,IAAI,CACV,CAAC,uCAAuC,EAAE9B,KAAK,IAAI,EACjDM,MAAM,gBAAgBJ,QAAQC,GAAG,CAACI,QAAQ,CAC3C,CAAC;AAEN,GACCgB,KAAK,CAACE,QAAQC,KAAK;AAEtB,QAAQ;AACR,MAAMK,aAAa,CAACC;IAClBP,QAAQK,IAAI,CAAC;IACb5B,QAAQ+B,IAAI,CAACD;AACf;AAEA9B,QAAQgC,EAAE,CAAC,QAAQ,CAACF,OAASD,WAAWC"}